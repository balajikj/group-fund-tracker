<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group Fund Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="page">
        <div class="login-container">
            <h1>üè¶ Group Fund Tracker</h1>
            <p class="subtitle">Zero-Cost Serverless Fund Management</p>
            
            <div class="login-box">
                <!-- Login Tabs -->
                <div class="login-tabs">
                    <button class="tab-btn active" onclick="showLoginTab('admin')">üîê Admin Login</button>
                    <button class="tab-btn" onclick="showLoginTab('member')">üë§ Member Login</button>
                </div>
                
                <!-- Admin Login Form -->
                <form id="adminLoginForm" class="login-form active">
                    <h2>Admin Login</h2>
                    <div class="form-group">
                        <label for="adminEmail">Email</label>
                        <input type="email" id="adminEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password</label>
                        <input type="password" id="adminPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login as Admin</button>
                    <div id="adminLoginError" class="error-message"></div>
                </form>
                
                <!-- Member Login Form -->
                <form id="memberLoginForm" class="login-form">
                    <h2>Member Login</h2>
                    <div class="form-group">
                        <label for="memberIdentifier">Member Identifier</label>
                        <input type="text" id="memberIdentifier" placeholder="Enter your unique identifier" required autocomplete="off">
                        <small style="color: #64748b; display: block; margin-top: 5px;">
                            üí° Get your identifier from the admin
                        </small>
                    </div>
                    <button type="submit" class="btn btn-success">Login as Member</button>
                    <div id="memberLoginError" class="error-message"></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboardPage" class="page hidden">
        <header>
            <div class="header-content">
                <h1>Group Fund Tracker</h1>
                <div class="user-info">
                    <span id="userName">Welcome, User</span>
                    <span id="userRole" class="role-badge"></span>
                    <button id="logoutBtn" class="btn btn-secondary">Logout</button>
                </div>
            </div>
        </header>

        <main class="dashboard">
            <!-- Fund Status Overview -->
            <section class="card">
                <h2>üí∞ Common Fund Status</h2>
                <div class="fund-metrics">
                    <div class="metric">
                        <div class="metric-label">Current Total Fund</div>
                        <div class="metric-value" id="totalFund">‚Çπ0.00</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Total Outstanding Loans</div>
                        <div class="metric-value" id="outstandingLoans">‚Çπ0.00</div>
                    </div>
                    <div class="metric highlight">
                        <div class="metric-label">Total Amount</div>
                        <div class="metric-value" id="totalAmount">‚Çπ0.00</div>
                    </div>
                </div>
            </section>

            <!-- Budget Breakdown -->
            <section class="card">
                <h2>üìä Budget Allocation</h2>
                <div class="budget-breakdown">
                    <div class="budget-item">
                        <span class="budget-label">üöó Travel Budget (10%)</span>
                        <span class="budget-value" id="travelBudget">‚Çπ0.00</span>
                    </div>
                    <div class="budget-item">
                        <span class="budget-label">üè• Medical Emergency (20%)</span>
                        <span class="budget-value" id="medicalBudget">‚Çπ0.00</span>
                    </div>
                    <div class="budget-item">
                        <span class="budget-label">üíµ Lending Fund (50%)</span>
                        <span class="budget-value" id="lendingBudget">‚Çπ0.00</span>
                    </div>
                    <div class="budget-item">
                        <span class="budget-label">üíº Reserve (20%)</span>
                        <span class="budget-value" id="reserveBudget">‚Çπ0.00</span>
                    </div>
                </div>
            </section>

            <!-- Personal Contribution -->
            <section class="card">
                <h2>üë§ My Contribution</h2>
                <div class="personal-stats">
                    <div class="metric">
                        <div class="metric-label">My Lifetime Contribution</div>
                        <div class="metric-value" id="myContribution">‚Çπ0.00</div>
                    </div>
                </div>
                <div style="margin-top: 1rem; text-align: center; display: flex; gap: 0.5rem; justify-content: center;">
                    <button id="requestContributionBtn" class="btn btn-success">‚ûï Request Contribution</button>
                    <button id="requestLoanBtn" class="btn btn-warning">üí∏ Request Loan</button>
                </div>
            </section>

            <!-- My Loan Requests (Member View) -->
            <section id="myLoanRequestsPanel" class="card hidden">
                <h2>üìã My Loan Requests</h2>
                <div class="table-container">
                    <table id="myLoanRequestsTable">
                        <thead>
                            <tr>
                                <th>Request Date</th>
                                <th>Amount</th>
                                <th>Due Date</th>
                                <th>Status</th>
                                <th>Decision Details</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="myLoanRequestsTableBody">
                            <tr>
                                <td colspan="6" class="no-data">No loan requests yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Pending Requests (Visible to all, Actions Admin-only) -->
            <section id="pendingRequestsPanel" class="card hidden">
                <h2>üìã Pending Contribution Requests</h2>
                <div class="table-container">
                    <table id="requestsTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Member</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Comments</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="requestsTableBody">
                            <tr>
                                <td colspan="6" class="no-data">No pending requests</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Pending Loan Requests (Admin Only) -->
            <section id="pendingLoanRequestsPanel" class="card hidden">
                <h2>üí∏ Pending Loan Requests</h2>
                <div class="table-container">
                    <table id="pendingLoanRequestsTable">
                        <thead>
                            <tr>
                                <th>Requested</th>
                                <th>Member</th>
                                <th>Amount</th>
                                <th>Due Date</th>
                                <th>Reason</th>
                                <th>Member Info</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pendingLoanRequestsTableBody">
                            <tr>
                                <td colspan="7" class="no-data">No pending loan requests</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Admin Actions (Admin Only) -->
            <section id="adminPanel" class="card hidden">
                <h2>‚öôÔ∏è Admin Actions</h2>
                <div class="admin-actions">
                    <button id="addLoanBtn" class="btn btn-warning">üí∏ Disburse Loan</button>
                    <button id="recordReturnBtn" class="btn btn-info">‚úÖ Record Loan Return</button>
                    <button id="addExpenseBtn" class="btn btn-danger">üí∞ Add Expense</button>
                </div>
            </section>

            <!-- Admin Only Actions (Only visible to Admin) -->
            <section id="adminOnlyPanel" class="card hidden">
                <h2>üîê Admin Only Actions</h2>
                <div class="admin-actions">
                    <button id="addMemberBtn" class="btn btn-primary">üë§ Add Member</button>
                </div>
            </section>

            <!-- Members List (Admin Only) -->
            <section id="membersPanel" class="card hidden">
                <h2>üë• Members List</h2>
                <div class="table-container">
                    <table id="membersTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Role</th>
                                <th>Lifetime Contribution</th>
                            </tr>
                        </thead>
                        <tbody id="membersTableBody">
                            <tr>
                                <td colspan="3" class="no-data">Loading members...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Active Loans -->
            <section class="card">
                <h2>üìã Active Loans</h2>
                <div class="table-container">
                    <table id="loansTable">
                        <thead>
                            <tr>
                                <th>Borrower</th>
                                <th>Amount</th>
                                <th>Paid</th>
                                <th>Remaining</th>
                                <th>Borrowed Date</th>
                                <th>Due Date</th>
                                <th>Days Remaining</th>
                            </tr>
                        </thead>
                        <tbody id="loansTableBody">
                            <tr>
                                <td colspan="7" class="no-data">No active loans</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Transaction History -->
            <section class="card">
                <h2>üìú Transaction History</h2>
                <div class="table-container">
                    <table id="transactionsTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Member</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Comments</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTableBody">
                            <tr>
                                <td colspan="5" class="no-data">No transactions yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="transactionPagination" class="pagination hidden">
                    <button id="prevTransactionPage" class="btn-pagination" disabled>‚Üê Previous</button>
                    <span id="transactionPageInfo" class="page-info">Page 1 of 1</span>
                    <button id="nextTransactionPage" class="btn-pagination" disabled>Next ‚Üí</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Admin Forms -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Application Scripts -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script src="app.js"></script>
    <script src="admin.js"></script>
</body>
</html>
